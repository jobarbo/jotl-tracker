---
import Card from "./Card.astro";
import Button from "./Button.astro";
import ProgressBar from "./ProgressBar.astro";
import type {CampaignSummary} from "../types/index.js";

export interface Props {
	campaign: CampaignSummary;
	showActions?: boolean;
	size?: "sm" | "md" | "lg";
}

const {campaign, showActions = true, size = "md"} = Astro.props;

const sizeClasses = {
	sm: "text-sm",
	md: "text-base",
	lg: "text-lg",
};
---

<Card variant='hover' class='transition-all duration-200 hover:shadow-lg'>
	<!-- Campaign Header -->
	<div class='border-b border-gray-700 mb-4 pb-4'>
		<div class='flex justify-between items-start'>
			<div>
				<h3 class={`font-semibold text-white ${size === "lg" ? "text-2xl" : size === "md" ? "text-xl" : "text-lg"}`}>
					{campaign.name}
				</h3>
				<p class='text-gray-400 text-sm mt-1'>{campaign.groupName}</p>
				<p class='text-gray-500 text-xs mt-1'>
					Created {new Date(campaign.createdAt).toLocaleDateString()}
				</p>
			</div>
			<span class='text-xs text-gray-400 bg-gray-700 px-2 py-1 rounded'>
				{campaign.groupName}
			</span>
		</div>
	</div>

	<!-- Campaign Stats -->
	<div class='grid grid-cols-2 gap-4 mb-4'>
		<div class='text-center'>
			<div class={`font-bold text-white ${size === "lg" ? "text-3xl" : size === "md" ? "text-2xl" : "text-xl"}`}>
				{campaign.characterCount}
			</div>
			<div class='text-sm text-gray-400'>Characters</div>
		</div>
		<div class='text-center'>
			<div class={`font-bold text-white ${size === "lg" ? "text-3xl" : size === "md" ? "text-2xl" : "text-xl"}`}>
				{campaign.completedScenarios}/{campaign.totalScenarios}
			</div>
			<div class='text-sm text-gray-400'>Scenarios</div>
		</div>
	</div>

	<!-- Progress Bar -->
	<div class='mb-4'>
		<ProgressBar value={campaign.completedScenarios} max={campaign.totalScenarios} showPercentage={true} label='Progress' />
	</div>

	<!-- Last Played -->
	<div class='text-sm text-gray-400 mb-4'>
		<span class='font-medium'>Last played:</span>
		<span class='ml-1'>
			{campaign.lastPlayed ? new Date(campaign.lastPlayed).toLocaleDateString() : "Never"}
		</span>
	</div>

	{
		showActions && (
			<div class='flex space-x-2'>
				<Button href={`/campaigns/${campaign.id}`} variant='primary' size='sm' class='flex-1 text-center'>
					View Details
				</Button>
				<Button href={`/campaigns/${campaign.id}/edit`} variant='secondary' size='sm' class='flex-1 text-center'>
					Edit
				</Button>
			</div>
		)
	}
</Card>
